stages:
  - train

train-model:
  stage: train
  image: amazon/aws-cli:2.15.0
  script:
    - echo "Starting training pipeline..."
    - aws stepfunctions start-execution \
        --state-machine-arn "$STEP_FUNCTION_ARN" \
        --name "train-${CI_COMMIT_SHORT_SHA}-${CI_PIPELINE_ID}" \
        --input "{\"source\":\"gitlab-ci\",\"commit\":\"$CI_COMMIT_SHORT_SHA\"}"
  only:
    - main
